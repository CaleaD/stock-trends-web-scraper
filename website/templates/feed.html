{% extends "base.html" %}

{% block content %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='/style/display.css') }}">
    <section class="bg-dark text-light text-center">
            <h1>
                Stock <span>Market</span> News <span>Data</span>
            </h1>

            <p style = "font-size: 15px; font-weight: bold;">
                The feed is generated by refreshing the page, not by clicking the button!
            </p>


            <button onclick = "constructTable('#table')">
                click here
            </button>

            <br><br>

            <table align = "center"
                    id="table" border="1">
            </table>

            <script>
                var el_up = document.getElementById("GFG_UP");

                var list = {{data|tojson}};

                function constructTable(selector) {
                    var cols = Headers(list, selector);
                    for (var i = 0; i < list.length; i++) {
                        var row = $('<tr/>');
                        row.append($('<td/>').html(list[i][cols[0]]));
                        for (var colIndex = 1; colIndex < cols.length; colIndex++)
                        {
                            var val = list[i][cols[colIndex]];
                            if (val == null) val = "";
                            if(colIndex===3){
                                row.append($('<td/>').html(val));
                            }
                            else{
                                row.append($('<td/>').html(val));
                            }
                        }
                        $(selector).append(row);
                    }
                }

                function Headers(list, selector) {
                    var columns = [];
                    var header = $('<tr/>');

                    for (var i = 0; i < list.length; i++) {
                        var row = list[i];

                        for (var k in row) {
                            if ($.inArray(k, columns) == -1) {
                                columns.push(k);

                                // Creating the header
                                header.append($('<th/>').html(k));
                            }
                        }
                    }

                    // Appending the header to the table
                    $(selector).append(header);
                        return columns;
                }
        </script>
    </section>
{% endblock %}